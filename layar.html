<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>TV Antrian PLN</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #125d72, #14a2ba);
  color: white;
  overflow: hidden;
}

/* HEADER */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #0f4c5c;
  padding: 18px 35px;
}
.header img { height: 60px; }

.header-center {
  text-align: center;
  font-size: 16px;
  line-height: 1.4;
}
.header-center strong {
  font-size: 18px;
  letter-spacing: 2px;
}

/* MARQUEE */
.marquee {
  background: rgba(255,255,255,0.15);
  padding: 10px;
  font-size: 18px;
}

/* MAIN */
.main {
  height: calc(100vh - 230px);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
.main h1 {
  font-size: 52px;
  letter-spacing: 4px;
  color: #e7f6f9;
}

/* NOMOR */
.nomor {
  font-size: 280px;
  color: #efe62f;
  font-weight: bold;
  margin: 0;
  transition: transform 0.6s ease, opacity 0.6s ease;
}
.nomor.active {
  text-shadow: 0 0 40px rgba(239,230,47,0.8);
  animation: pulse 1.5s infinite;
}
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.04); }
  100% { transform: scale(1); }
}

.status {
  font-size: 26px;
  margin-top: 10px;
  color: #e7f6f9;
}

/* JAM */
.jam {
  margin-top: 20px;
  font-size: 20px;
  color: #d9d9d9;
}

/* FOOTER */
.footer {
  background: #efe62f;
  color: #125d72;
  text-align: center;
  padding: 14px;
  font-weight: bold;
  letter-spacing: 1px;
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
  <img src="https://upload.wikimedia.org/wikipedia/commons/a/a2/Kementerian_BUMN_%28logo_only%29.png">

  <div class="header-center">
    <strong>PLN PURWAKARTA</strong><br>
    Jl. Singawinata, Nagri Tengah, Purwakarta
  </div>

  <div>
    <img src="https://upload.wikimedia.org/wikipedia/commons/9/97/Logo_PLN.png">
  </div>
</div>

<!-- MARQUEE -->
<div class="marquee">
  <marquee scrollamount="4">
    Pastikan membawa KTP dan ID Pelanggan • Layanan tutup pukul 15.00 WIB • Terima kasih telah menunggu
  </marquee>
</div>

<!-- MAIN -->
<div class="main">
  <h1>NOMOR ANTRIAN</h1>
  <div class="nomor" id="nomor">-</div>
  <div class="status" id="status">Menunggu</div>
  <div class="jam" id="jam"></div>
</div>

<!-- FOOTER -->
<div class="footer">
  Listrik untuk Kehidupan yang Lebih Baik
</div>

<!-- ===== FIREBASE (READ ONLY) ===== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBjyq3YZUXhkufKELDGknIl240rA1pNai4",
  authDomain: "sistem-antrian-pln-pwk-kota.firebaseapp.com",
  databaseURL: "https://sistem-antrian-pln-pwk-kota-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "sistem-antrian-pln-pwk-kota",
  storageBucket: "sistem-antrian-pln-pwk-kota.firebasestorage.app",
  messagingSenderId: "170815122877",
  appId: "1:170815122877:web:0abdf259e2aa64d8c3b6d4"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const nomorRef = ref(db, "antrian/nomor");

const elNomor = document.getElementById("nomor");
const elStatus = document.getElementById("status");

let lastNomor = null;

onValue(nomorRef, (snapshot) => {
  const nomor = snapshot.val();

  if (nomor !== lastNomor) {
    elNomor.classList.remove("active");
    elNomor.style.opacity = "0";
    elNomor.style.transform = "scale(0.7)";

    setTimeout(() => {
      elNomor.innerText = nomor && nomor != 0 ? nomor : "-";
      elNomor.style.opacity = "1";
      elNomor.style.transform = "scale(1)";
      if (nomor && nomor != 0) elNomor.classList.add("active");
    }, 300);

    lastNomor = nomor;
  }

  elStatus.innerText = nomor && nomor != 0 ? "Sedang Dipanggil" : "Menunggu";
});

// JAM DIGITAL
setInterval(() => {
  const now = new Date();
  document.getElementById("jam").innerText =
    now.toLocaleDateString("id-ID", {
      weekday:"long",
      day:"numeric",
      month:"long",
      year:"numeric"
    }) + " | " +
    now.toLocaleTimeString("id-ID");
}, 1000);
</script>

</body>
</html>
